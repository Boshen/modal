{"version":3,"file":"bundle.js","sources":["../src/modal.ts","index.ts"],"sourcesContent":["export interface ModalProps {\n  content: HTMLElement\n  zIndex?: number\n  closeOnOverlay?: boolean\n  useKeyboard?: boolean\n  onOpen?: (modal: Modal) => void\n  onClose?: (modal: Modal) => void\n  onClick?: (e: MouseEvent, modal: Modal) => void\n}\n\nconst noop = () => {}\n\nexport class Modal {\n  private static modalsOpened: Modal[] = []\n\n  private readonly content: HTMLElement\n  private readonly closeOnOverlay: boolean\n  private readonly zIndex: number\n  private readonly useKeyboard: boolean\n  private readonly onClickModal: ((e: MouseEvent, modal: Modal) => void)\n  private readonly onOpenModal: ((modal: Modal) => void)\n  private readonly onCloseModal: ((modal: Modal) => void)\n\n  private modal: HTMLElement | null = null\n  private overlay: HTMLElement | null = null\n\n  /**\n   * Create a Modal, the modal is not opened yet\n   * @param {HTMLElement} content - the html content inside the modal\n   * @param {boolean} [closeOnOverlay=true] - close the modal if the overflay is clicked\n   * @param {boolean} [zIndex=1000] - z index of the modal\n   * @param {boolean} [useKeyboard=true] - handle keyboard events (esc will close the modal)\n   * @param {clickModalCallback} [onClick] - callback for mouse events on the modal\n   * @param {modalCallback} [onOpen] - callback when the modal is opened\n   * @param {modalCallback} [onClose] - callback when the modal is closed\n   *\n   */\n  constructor({\n    content,\n    closeOnOverlay = true,\n    zIndex = 1000,\n    useKeyboard = true,\n    onClick = noop,\n    onOpen = noop,\n    onClose = noop,\n  }: ModalProps) {\n    this.content = content\n    this.closeOnOverlay = closeOnOverlay\n    this.zIndex = zIndex\n    this.useKeyboard = useKeyboard\n    this.onClickModal = onClick\n    this.onOpenModal = onOpen\n    this.onCloseModal = onClose\n  }\n\n  /**\n   * Open the modal\n   */\n  public open() {\n    Modal.modalsOpened.push(this)\n    this.openModal()\n    this.addEventListeners()\n  }\n\n  /**\n   * Close the modal\n   */\n  public close() {\n    Modal.modalsOpened.pop()\n    this.removeEventListeners()\n    this.closeModal()\n  }\n\n  private addEventListeners() {\n    this.modal!.addEventListener('click', this.handleClick)\n    if (this.useKeyboard) {\n      document.addEventListener('keydown', this.handleEsc)\n    }\n  }\n\n  private removeEventListeners() {\n    this.modal!.removeEventListener('click', this.handleClick)\n    if (this.useKeyboard) {\n      document.removeEventListener('keydown', this.handleEsc)\n    }\n  }\n\n  private handleEsc = (e: KeyboardEvent) => {\n    if (e.keyCode === 27) {\n      Modal.modalsOpened[Modal.modalsOpened.length - 1].close()\n    }\n  }\n\n  private handleClick = (e: MouseEvent) => {\n    this.onClickModal(e, this)\n    if (e.target === this.overlay && this.closeOnOverlay) {\n      this.close()\n    }\n  }\n\n  private openModal() {\n    this.modal = document.createElement('div')\n    this.overlay = document.createElement('div')\n    const container = document.createElement('div')\n\n    document.body.appendChild(this.modal)\n    this.modal.appendChild(this.overlay)\n    this.overlay.appendChild(container)\n    container.appendChild(this.content)\n\n    this.modal.setAttribute(\n      'style',\n      `\n      z-index: ${this.zIndex}\n      `\n    )\n    this.overlay.setAttribute(\n      'style',\n      `\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: ${Modal.modalsOpened.length === 1 ? 'rgba(0,0,0,.6)' : 'default'};\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    `\n    )\n    container.setAttribute(\n      'style',\n      `\n      background-color: #fff;\n      max-height: 80vh;\n      overflow-y: auto;\n    `\n    )\n\n    this.toggleBodyScroll(false)\n    this.modal.style.transition = 'opacity .3s ease-out'\n    this.modal.style.opacity = '0'\n    window.setTimeout(() => {\n      this.modal!.style.opacity = '1'\n      this.onOpenModal(this)\n    }, 1)\n  }\n\n  private closeModal() {\n    if (!this.modal) {\n      return\n    }\n    this.modal.style.transition = 'opacity .15s ease-in'\n    this.modal.style.opacity = '0'\n    window.setTimeout(() => {\n      this.toggleBodyScroll(true)\n      this.modal!.remove()\n      this.onCloseModal(this)\n    }, 150)\n  }\n\n  private toggleBodyScroll(openScroll: boolean) {\n    const body = document.querySelector('body')!\n    if (!openScroll && Modal.modalsOpened.length === 1) {\n      body.style.overflow = 'hidden'\n      body.style.paddingRight = '15px'\n    }\n    if (openScroll && Modal.modalsOpened.length === 0) {\n      body.style.overflow = null\n      body.style.paddingRight = null\n    }\n  }\n}\n\n/**\n * The callback for when the modal is clicked\n * @callback clickModalCallback\n * @param {MouseEvent} event - the mouse event\n * @param {Modal} modal - the modal itself\n */\n\n/**\n * The callback for modal events\n * @callback modalCallback\n * @param {Modal} modal - the modal itself\n */\n","import { Modal, ModalProps } from '../src'\n\nconst createModal = (modalStyle: string, modalHtml: string, modalOptions: Partial<ModalProps> = {}) => {\n  const modalContent = document.createElement('div')\n  modalContent.setAttribute('style', modalStyle)\n  modalContent.innerHTML = modalHtml\n  return new Modal({\n    content: modalContent,\n    onOpen: (m: Modal) => console.info('modal open', m),\n    onClose: (m: Modal) => console.info('modal closed', m),\n    ...modalOptions,\n  })\n}\n\nconst createButton = (modal: Modal, buttonText: string) => {\n  const button = document.createElement('button')\n  document.body.appendChild(button)\n  button.innerText = buttonText\n  button.onclick = () => modal.open()\n}\n\n/**\n * Simple Modal with a close icon\n */\nconst modal1 = createModal(\n  `\n    padding: 30px;\n    width: 500px;\n    height: 300px;\n    border-radius: 3px;\n    `,\n  `\n    <div>\n      <div style=\"display: flex;justify-content: space-between;align-items: center;\">\n        <h1>Basic Alert Modal</h1>\n        <div data-modal-close style=\"cursor:pointer\">âœ—</div>\n      </div>\n      <div>Modal Body</div>\n    </div>\n    `,\n  {\n    zIndex: 3000,\n    onClick: (e: MouseEvent, modal: Modal) => {\n      const target = e.target as HTMLElement\n      if ('modalClose' in target.dataset) {\n        console.info('close modal')\n        modal.close()\n      }\n    },\n  }\n)\ncreateButton(modal1, 'Basic Modal')\n\n/**\n * Modal content needs a scroll\n */\nconst modal2 = createModal(\n  `\n    padding: 30px;\n    width: 500px;\n    `,\n  `\n    <div style=\"height: 150vh\">\n      <h1>Scroll Modal</h1>\n      <div>Scroll Modal Body</div>\n    </div>\n    `\n)\ncreateButton(modal2, 'Basic Modal')\n\n/**\n * Confirm modal all close options all turned off (esc and clicking on overlay)\n */\nconst modal3 = createModal(\n  `\n    padding: 30px;\n    width: 500px;\n    `,\n  `\n    <div>\n      <h1>Confirm Modal</h1>\n      <div style=\"height:150px\">Alert Modal Body</div>\n      <div>\n        <button data-modal-confirm>Confirm</button>\n        <button data-modal-cancel>Cancel</button>\n      </div>\n    </div>\n    `,\n  {\n    closeOnOverlay: false,\n    useKeyboard: false,\n    onClick: (e: MouseEvent, modal: Modal) => {\n      const target = e.target as HTMLElement\n      if ('modalConfirm' in target.dataset) {\n        console.info('confirm modal')\n        modal.close()\n      }\n      if ('modalCancel' in target.dataset) {\n        console.info('cancel modal')\n        modal.close()\n      }\n    },\n  }\n)\ncreateButton(modal3, 'Confirm Modal')\n\n/*\n * Creating new modals in side modals\n */\nconst modalInModal = (n: number) => {\n  return createModal(\n    `\n      padding: 30px;\n      width: 500px;\n      height: ${n * 100 + 300}px;\n      `,\n    `\n      <div>\n        <h1>Modal Over Modal ${n}</h1>\n        <div>\n          <button data-modal-new>another modal</button>\n        </div>\n      </div>\n      `,\n    {\n      onClick: (e: MouseEvent) => {\n        const target = e.target as HTMLElement\n        if ('modalNew' in target.dataset) {\n          console.info('create modal modal')\n          const modal = modalInModal(n + 1)\n          modal.open()\n        }\n      },\n    }\n  )\n}\n\ncreateButton(modalInModal(0), 'Modal Over Modal')\n"],"names":[],"mappings":"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"}